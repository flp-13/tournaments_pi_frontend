import{_ as Q,d as B,r as C,a as T,b as W,e as A,n as z,w as S,o as _,c as V,f as h,g as X,v as Y,u,h as Z,t as N,i as R,j as ee,p as te,k as ne,l as q,m as f,q as k,s as m,x as I,y as U,z as G,F as P,A as ae,B as oe,C as se,D as $,E as le,G as O,H as ue}from"./index.f460c7b2.js";import{l as j}from"./lodash.dd9bff61.js";const re=p=>(te("data-v-477045bb"),p=p(),ne(),p),ie={class:"input-group-wrapper"},de={key:0},me=re(()=>h("div",{class:"invalid-feedback"},null,-1)),ce=B({props:{modelValue:{default:""},autosize:{type:Boolean,default:!0},minHeight:{default:null},maxHeight:{default:null},important:{type:[Boolean,Array],default:!1},label:null,id:{default:""},name:{default:""}},emits:["update:modelValue"],setup(p,{emit:g}){const n=p,e=C({val:"",maxHeightScroll:!1,height:"auto",focused:!1}),c=T();e.val=n.modelValue,W(()=>{o()});const v=A(()=>{const t=n.important;return t===!0||Array.isArray(t)&&t.includes("resize")}),a=A(()=>{const t=n.important;return t===!0||Array.isArray(t)&&t.includes("overflow")}),i=A(()=>{const t=n.important;return t===!0||Array.isArray(t)&&t.includes("height")});function o(){const t=i.value?"important":"";e.height=`auto${t?" !important":""}`,z(()=>{let r=c.value.scrollHeight+1;n.minHeight&&(r=r<n.minHeight?n.minHeight:r),n.maxHeight&&(r>n.maxHeight?(r=n.maxHeight,e.maxHeightScroll=!0):e.maxHeightScroll=!1);const x=`${r}px`;e.height=`${x}${t?" !important":""}`})}const b=A(()=>n.autosize?{resize:v.value?"none":"none !important",height:e.height,overflow:e.maxHeightScroll?"auto":a.value?"hidden !important":"hidden"}:{});return S(()=>n.modelValue,()=>{e.val=n.modelValue}),S(()=>e.val,t=>{z(o),g("update:modelValue",t)}),S(()=>n.minHeight,()=>{z(o)}),S(()=>n.maxHeight,()=>{z(o)}),S(()=>n.autosize,t=>{t&&o()}),(t,r)=>(_(),V("div",ie,[h("div",{class:ee(["input-group",{"has-value":u(e).val,[u(e).focused?"focused":"blurred"]:!0}])},[X(h("textarea",{ref_key:"textarea",ref:c,"onUpdate:modelValue":r[0]||(r[0]=x=>u(e).val=x),style:Z(u(b)),rows:"1",onFocus:o,onFocusin:r[1]||(r[1]=x=>u(e).focused=!0),onFocusout:r[2]||(r[2]=x=>u(e).focused=!1)},null,36),[[Y,u(e).val]]),p.label?(_(),V("label",de,N(p.label),1)):R("",!0)],2),me]))}});var pe=Q(ce,[["__scopeId","data-v-477045bb"]]);const _e={class:"flex"},fe=k(" Submit Tournament "),he=B({props:{tournament:null},emits:["submit"],setup(p,{emit:g}){var a;const n=p,e=T(!1),c=C((a=n.tournament)!=null?a:{id:null,name:"",description:""});function v(){e.value=!0,g("submit",c,()=>{e.value=!1})}return S(()=>n.tournament,()=>{var i;Object.assign(c,(i=n.tournament)!=null?i:{id:null,name:"",description:""})},{deep:!0}),(i,o)=>{const b=I,t=pe,r=U,x=G;return _(),q(x,{"is-form":"",onSubmit:v},{title:f(()=>[k(N(u(c).id?"Edit":"Add")+" Tournament ",1)]),footer:f(()=>[h("div",_e,[m(r,{class:"ml-auto btn btn-brand-primary",type:"submit",loading:e.value},{default:f(()=>[fe]),_:1},8,["loading"])])]),default:f(()=>[m(b,{modelValue:u(c).name,"onUpdate:modelValue":o[0]||(o[0]=H=>u(c).name=H),label:"Tournament Title",type:"text",name:"name"},null,8,["modelValue"]),m(t,{modelValue:u(c).description,"onUpdate:modelValue":o[1]||(o[1]=H=>u(c).description=H),label:"Tournament Description",rows:"1",class:"text-black"},null,8,["modelValue"])]),_:1})}}}),ge=k(" Change Password "),ve=k(" Change Password "),we=k(" Change Password "),be=B({emits:["submit"],setup(p,{emit:g}){const n=T(!1),e=C({oldPassword:"",password:"",password_confirmation:""});function c(){g("submit",e,()=>{n.value=!1})}return(v,a)=>{const i=U,o=I,b=G;return _(),V(P,null,[m(i,{class:"btn btn-theme-danger block my-4",onClick:a[0]||(a[0]=t=>n.value=!0)},{default:f(()=>[ge]),_:1}),m(b,{show:n.value,"is-form":"",onClose:a[4]||(a[4]=t=>n.value=!1),onSubmit:c},{title:f(()=>[ve]),footer:f(()=>[m(i,{class:"btn btn-theme-danger",type:"submit"},{default:f(()=>[we]),_:1})]),default:f(()=>[m(o,{id:"change-password__old-password",modelValue:u(e).oldPassword,"onUpdate:modelValue":a[1]||(a[1]=t=>u(e).oldPassword=t),type:"password",name:"oldPassword",label:"Old Password"},null,8,["modelValue"]),m(o,{id:"change-password__new-password",modelValue:u(e).password,"onUpdate:modelValue":a[2]||(a[2]=t=>u(e).password=t),type:"password",name:"newPassword",label:"Password"},null,8,["modelValue"]),m(o,{id:"change-password__confirm-password",modelValue:u(e).password_confirmation,"onUpdate:modelValue":a[3]||(a[3]=t=>u(e).password_confirmation=t),type:"password",name:"confirmPassword",label:"Confirm Password"},null,8,["modelValue"])]),_:1},8,["show"])],64)}}}),xe={container:"","mx-auto":""},ye=h("h1",{class:"text-2xl"}," My Profile ",-1),Ve=h("hr",{"my-3":""},null,-1),$e=["onSubmit"],ke=k(" Edit "),Se=h("h2",{class:"text-2xl"}," My Tournaments ",-1),Te=h("hr",{"my-3":""},null,-1),He={class:"text-center"},Pe=k(" Add Tournament "),Ce={class:"mt-5 flex flex-col items-center gap-5"},Ae={key:1,"text-center":""},Me=B({setup(p){const g=ae(),n=oe(),e=se(),c=T(!0),v=T(!1),a=T({username:"",email:""}),i=C({id:null,name:"",description:""}),o=C({count:0,next_page:null,prev_page:null,results:null,total_pages:0});g.id?b():(c.value=!1,n.replace("/")),g.$subscribe((s,l)=>{l.id||(n.push("/"),c.value=!1),b()});function b(){$.get("/me").then(s=>{var l,d;a.value.username=(l=s.data.name)!=null?l:"",a.value.email=(d=s.data.email)!=null?d:""}),$.get(`tournaments?user=${g.id}`).then(s=>{Object.assign(o,s.data)})}function t(){$.put("/me",a.value).then(s=>{var l,d;localStorage.setItem("token",s.data.token),g.name=(d=(l=a.value)==null?void 0:l.username)!=null?d:"",$.defaults.headers.common.Authorization=`Bearer ${s.data.token}`})}function r(s,l){$.put("/me/password",s).then(()=>{e.success("Password changed"),l&&l()})}function x(){i.id=null,i.name=i.description="",v.value=!0}function H(s,l){if(s.id){$.put(`/tournaments/${s.id}`,j.exports.pick(s,["name","description"])).then(d=>{if(o.results){const w=o.results.find(M=>M.id===s.id);Object.assign(w,s),D()}}).catch(d=>{var w;e.error((w=d.response)==null?void 0:w.data.message)}).finally(()=>{l&&l()});return}$.post("/tournaments",s).then(d=>{if(o.results===null){o.results=[d.data];return}o.results.unshift(d.data),D()}).catch(d=>{var w;e.error((w=d.response)==null?void 0:w.data.message)}).finally(()=>{l&&l()})}function D(){i.name=i.description="",v.value=!1}function L(s){v.value=!0,Object.assign(i,j.exports.pick(s,["id","name","description"]))}function J(s){$.delete(`/tournaments/${s}`).then(()=>{b()})}return(s,l)=>{const d=I,w=U,M=be,E=ue,K=he;return _(),V(P,null,[h("div",xe,[ye,Ve,a.value?(_(),V("form",{key:0,onSubmit:le(t,["prevent"])},[m(d,{modelValue:a.value.username,"onUpdate:modelValue":l[0]||(l[0]=y=>a.value.username=y),label:"Username",name:"username"},null,8,["modelValue"]),m(d,{modelValue:a.value.email,"onUpdate:modelValue":l[1]||(l[1]=y=>a.value.email=y),label:"Email",name:"email"},null,8,["modelValue"]),m(w,{class:"btn btn-theme-warning",type:"submit"},{default:f(()=>[ke]),_:1}),m(M,{onSubmit:r})],40,$e)):R("",!0),Se,Te,h("div",He,[m(w,{class:"btn btn-brand-primary",onClick:x},{default:f(()=>[Pe]),_:1})]),h("div",Ce,[u(o).results?(_(),V(P,{key:0},[u(o).results.length>0?(_(!0),V(P,{key:0},O(u(o).results,y=>{var F;return _(),q(E,{key:(F=y.id)!=null?F:0,tournament:y,"with-actions":"",onEdit:L,onDelete:J},null,8,["tournament"])}),128)):(_(),V("div",Ae," No Tournaments Found "))],64)):(_(),V(P,{key:1},O(4,y=>m(E,{key:y,tournament:null})),64))])]),m(K,{show:v.value,tournament:u(i),onClose:l[2]||(l[2]=y=>v.value=!1),onSubmit:H},null,8,["show","tournament"])],64)}}});export{Me as default};
